# 楚留香音乐盒::使用帮助

欢迎使用同类软件中历史最悠久, 功能最先进, 效果最好并且完全开源免费的手机端自动演奏神器: 楚留香音乐盒  

## 1. 下载安装

事实上如果你是从脚本中"使用说明"点击进入本页面, 那么你已经安装好了。
否则请参考[https://github.com/happyme531/clxTools/blob/master/README.md](https://github.com/happyme531/clxTools/blob/master/README.md)中的说明。

## 2. 导入音乐文件

将音乐文件放入手机内部存储中的`楚留香音乐盒`目录下即可, 运行脚本就可以看到导入的文件。如果你看不到这个目录, 请先运行一次脚本, 之后再查看。  

目前支持的文件类型:  

1. MIDI:  
    这是世界上最为通用的音乐文件格式之一。
    文件后缀名为.mid。
    网上到处都能找到各种midi音乐, 你可以自行搜索下载想要的音乐。  
    我推荐的下载网站是: https://www.midishow.com/ 。注意: 下载需要积分, 但评论就可以获得等量的积分, 先试听评论后再下载即可。  
    - 如果你想要的音乐找不到midi格式但可以在b站找到原神弹琴视频, 这时使用 https://github.com/happyme531/GenshinImpactPianoExtract 可以将一段原神弹琴视频转换为脚本可用的MIDI文件。(效果不错)
    - 可以使用WIDI/piano-transcription/basicpitch等软件将mp3转换为midi。(效果不一定好)

2. DoMiSo:  
    这是Nigh@github.com开发的一种音乐文件格式。
    这些音乐文件的原后缀名为.txt, 为了脚本正常识别, 你需要将后缀名改为.dms.txt。
    参见: https://github.com/Nigh/DoMiSo-genshin  
 
3. 光遇 SkyStudio:  
    为光遇演奏设计的一种音乐文件格式。
    这些音乐文件的原后缀名为.txt, 为了脚本正常识别, 你需要将后缀名改为.skystudio.txt。
    - 在各种地方都能找到SkyStudio乐谱, 你可以自行搜索下载想要的音乐。
    - 可以下载[SkyStudio](https://play.google.com/store/apps/details?id=com.Maple.SkyStudio)进行编曲。
    - 在 https://github.com/StageGuard/SkyAutoPlayerScript 可以找到一些乐谱。  
    注意: 这个格式中音符的范围只有C4-C6, 总计15个.

## 3. 游戏选择

使用前请在 主菜单 -> 全局设置 -> 选择游戏/乐器 菜单中选择与你的游戏对应的选项。
如果没有对应的乐器, 选择"默认"即可。  

## 配置说明

#### 速度控制

- 变速:  
  调整播放速度, 使乐曲整体变快或变慢.  
- 限制点击速度:  
  通过限制最快的点击速度使乐曲较快的部分变慢, 而较慢的部分不变. 会在变速后应用.  

#### 时长控制(输出)

- 默认点击时长:  
  控制每次点击屏幕的时长. 建议尽量小, 除非点击太快游戏不识别. 一般情况下不需要调整.

#### 音域优化

- 半音处理方法:  
  乐曲中一个八度有12个音, 但大多游戏只有7个音(没有黑键). 对于没有对应音的音符, 可以选择向下取整/向上取整将其转换为有对应音的音符. 一般情况下不需要调整.
- 自动调整禁用音轨阈值:  
  对于有多个音轨的乐曲, 有些音轨可能音高很高/很低, 其中的一部分音符超出了游戏可以演奏的范围. 自动调整可以将这些音轨禁用, 优化演奏的效果. 这个值越高保留的音轨越多, 值越低禁用的音轨越多.
- 自动优化以下设置:  
  点击这个按钮来自动调节下面的两个设置, 优化演奏的效果. 很重要, 建议每次切换游戏/乐器/键位后点击一下, 以获得最佳效果.
- 升/降八度, 升/降半音:  
  调整乐曲的音高, 使其适应游戏的音域. "自动优化"会调节这两个设置, 一般不需要手动调整.
- 音轨选择:  
  有些MIDI文件中有多个音轨, 音轨的内容可能为主旋律, 伴奏, 和弦等, 可以在这里选择要演奏的音轨, 默认为所有音轨.  

## 附加功能: MIDI串流

  使用此功能可以实时演奏电脑上的MIDI文件，或者连接电子琴/MIDI键盘等设备直接在游戏中演奏。

  1. 将手机的**USB配置**设置为**MIDI**. 有些手机可以在连接USB后直接选择, 有些手机需要在**开发者选项**中设置.
  2. 连接手机到电脑, 此时电脑上会识别到MIDI设备.  
  3. 打开脚本的**MIDI串流**功能, 在电脑上选择MIDI输出设备为手机, 即可进行MIDI串流演奏.
